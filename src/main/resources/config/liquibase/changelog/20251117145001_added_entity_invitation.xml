<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
        http://www.liquibase.org/xml/ns/dbchangelog
        https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

  <!-- ========================================================= -->
  <!-- Invitation entity table                                    -->
  <!-- ========================================================= -->
  <changeSet id="20250215-1" author="you">

    <!-- Table -->
    <createTable tableName="invitation">
      <column name="id" type="bigint">
        <constraints primaryKey="true" nullable="false"/>
      </column>

      <column name="status" type="varchar(50)">
        <constraints nullable="false"/>
      </column>

      <column name="chat_room_id" type="bigint"/>
      <column name="user_id" type="bigint"/>

      <!-- Auditing fields from AbstractAuditingEntity -->
      <column name="created_by" type="varchar(50)"/>
      <column name="created_date" type="timestamp"/>
      <column name="last_modified_by" type="varchar(50)"/>
      <column name="last_modified_date" type="timestamp"/>
    </createTable>

    <!-- Sequence (JHipster standard name) -->
    <createSequence sequenceName="sequence_generator"/>

    <!-- Foreign key to chat_room -->
    <addForeignKeyConstraint
      baseColumnNames="chat_room_id"
      baseTableName="invitation"
      constraintName="fk_invitation_chatroom"
      referencedColumnNames="id"
      referencedTableName="chat_room"/>

    <!-- Foreign key to jhi_user -->
    <addForeignKeyConstraint
      baseColumnNames="user_id"
      baseTableName="invitation"
      constraintName="fk_invitation_user"
      referencedColumnNames="id"
      referencedTableName="jhi_user"/>

    <!-- Indexes -->
    <createIndex indexName="idx_invitation_chatroom"
                 tableName="invitation">
      <column name="chat_room_id"/>
    </createIndex>

    <createIndex indexName="idx_invitation_user"
                 tableName="invitation">
      <column name="user_id"/>
    </createIndex>

  </changeSet>
</databaseChangeLog>
